# ArgoCD values for Home Server (Colima + K3s)
# Uses Gateway API (HTTPRoute) instead of Ingress

global:
  domain: v2.argocd.haulrest.me

configs:
  params:
    server.insecure: true # TLS termination is handled by Gateway
  cm:
    url: https://v2.argocd.haulrest.me
    dex.config: |
      connectors:
      - type: github
        id: github
        name: GitHub
        config:
          clientID: $oauth-secret:clientId
          clientSecret: $oauth-secret:clientSecret
          loadAllGroups: true
          orgs:
            - name: BeaverHouse
  rbac:
    policy.csv: |
      g, BeaverHouse:Owner, role:admin

server:
  # Disable Ingress, use HTTPRoute instead
  ingress:
    enabled: false
  # Enable Gateway API HTTPRoute
  httproute:
    enabled: true
    parentRefs:
      - name: home-gateway
        namespace: nginx-gateway
        sectionName: https
